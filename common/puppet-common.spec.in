%global puppet_module_version __VERSION__

Name:		puppet-common
Version:	__VERSION__
#Release:	__RELEASE__%{?dist}	# use this to make dist specific builds
Release:	__RELEASE__
Summary:	A puppet module filled with common puppet utilities
License:	AGPLv3+
URL:		https://github.com/purpleidea/puppet-common
Source0:	https://dl.fedoraproject.org/pub/alt/purpleidea/puppet-common/SOURCES/puppet-common-%{puppet_module_version}.tar.bz2
BuildArch:	noarch

Requires: puppet >= 3.0.0
Requires: puppetlabs-stdlib >= 4.1.0

%description
Common puppet utilities that are useful for other puppet modules.

%prep
%setup -c -q -T -D -a 0

find %{_builddir} -type f -name ".*" -exec rm {} +
find %{_builddir} -size 0 -exec rm {} +
find %{_builddir} \( -name "*.pl" -o -name "*.sh"  \) -exec chmod +x {} +
find %{_builddir} \( -name "*.pp" -o -name "*.py"  \) -exec chmod -x {} +
find %{_builddir} \( -name "*.rb" -o -name "*.erb" \) -exec chmod -x {} + -exec sed -i "/^#!/{d;q}" {} +

%build

%install
rm -rf %{buildroot}
# _datadir is typically /usr/share/
install -d -m 0755 %{buildroot}/%{_datadir}/puppet/modules/
cp -r puppet-common-%{puppet_module_version} %{buildroot}/%{_datadir}/puppet/modules/common

%files
%{_datadir}/puppet/modules/*

# this changelog is auto-generated by git log
%changelog
